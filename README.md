# HANSOl-Guard-QA (한솔데코 건설 사고 대응 시스템) 👷🏼

**본 프로젝트는 RAG(Retrieval-Augmented Generation)을 기반으로 건설공사 사고 데이터를 활용하여 높은 품질의 사고 대응책을 생성하는 것을 목표로 합니다.**

## 1. 개요 
건설사고 발생 시 사고원인과 재발방지대책 및 향후조치계획서를 제출해야합니다. 
하지만 현장에서 관련 지침 종류와 필요한 내용만을 참고하는 것이 다소 어렵기 때문에 현장 근무자의 자체 판단에 맡겨 작성을 합니다. 

따라서 건설 현장의 사고 대응 역량 향상 및 효과적인 안전 관리 프로세스 구축을 위해 사고 상황 및 원인을 바탕으로 대응책을 자동 생성하는 시스템을 개발하고자 하였습니다. 


[서비스 흐름도]

## 2. 개발과정 

### 데이터 소개

- 23,422 건의 사고 상황 데이터 
(발생일시, 사고인지 시간, 날씨, 기온, 습도, 사고원인, 재발방지대책 및 향후조치계획 등)
- 104개의 건설안전지침관련 PDF 파일 

### 데이터 전처리
- CSV : 오타 및 띄어쓰기 수정, 동어 반복 제거, 불필요한 기호 삭제 등 
- PDF : 오픈소스모델인 **olmOCR**을 활용하여 텍스트 추출 ([olmOCR](https://huggingface.co/allenai/olmOCR-7B-0225-preview))

### 데이터 임베딩

- 임베딩 모델 : 한국어 임베딩 모델 intfloat/multilingual-e5-large 활용
- 벡터 DB : FAISS를 사용하여 벡터 임베딩 저장 및 유사도 검색 수행

### 유사문서 검색

- 쿼리 생성

```python
# csv query
f""""{공종} 중 {사고원인} 로 인해 사고가 발생했습니다.
해당 사고는 {작업프로세스} 중 발생했으며, 관련 사고 객체는 {부위} 입니다. 
이로 인한 인적피해는 {인적사고} 이고, 물적피해는 {물적사고} 로 확인됩니다."""

# pdf query 
f"""{공종}({부위}) 관련 {작업프로세스} 중 {사고원인}으로 인해 발생한 인적사고 : {인적사고} 및 물적사고 : {물적사고} 에 대한 안전 작업 지침 및 안전 조치 사항"""
```

- 유사문서 검색 
  - Ensemble Retriever :  
  - Reranking : 

### 답변 추론 및 생성

- QwQ-32B 모델 활용 (Reasoning Model 활용)
- `<think>` 태그를 활용하여 체계적인 분석 및 결론 도출에 대한 투명한 사고 과정 확인
- 관련문서 상위 3개를 프롬프트에 포함하여 논리적으로 대책을 생성하도록 유도
```python
"[발생한 사고]\n"
f"{question}\n"
"[유사 사고 사례 및 대응책]\n"
f"{csv_docs}\n"
"[사고 관련 안전 지침서]\n"
f"{pdf_docs}\n"
"위의 유사사고사례와 관련 안전 지침서를 참고하여, 발생한 사고에 대한 최적의 재발방지 대책 및 향후 조치 계획을 간결하게 작성해주세요.\n"
"반드시 '재발 방지 대응책:' 으로 시작하는 2줄 이내의 간결한 문장으로 답변하세요.\n"
"하나씩 차근차근 생각한 뒤, 최종 대응 대책을 도출하세요."
```

## 3. 기술 스택 

## 4. 향후 발전 계획 
- 모델 서빙 속도 향상 (vLLM, FAST API)
